# 03_CONSTRAINTS（制約・禁止事項）

## 技術制約（採用）
- **Vite + TypeScript** を採用し、モジュール分割する  
- **OneDrive（Graph）+ MSAL** で同期する（ローカル正、同期は後追い）  
- **保存はIndexedDB** を基本（スナップショットも保持）  
- ユーザー入力の表示は **原則 textContent**（innerHTMLは原則禁止。必要ならサニタイズ必須）  
- サーバ常設を必須にしない（静的配布で動くことを重視）

## 時間/工数（目安）
- まず **MVP（基盤改造の第一波）** を優先し、そこから改善ループへ移る  
- 巨大改修は避け、**1サイクル1改善**で進める（06参照）

## コスト上限
- 追加の有料API/サーバ費用は極力ゼロ（常時課金を避ける）

## セキュリティ/プライバシー（必須ガードレール）
- **秘密情報（鍵・トークン・APIキー）を出力しない**（ドキュメント/ログ/コミットに載せない）  
- **保存型XSSの防止**：ユーザー入力からスクリプトが動かない設計（innerHTML排除/サニタイズ）  
- **破壊的操作の禁止（無確認）**：全消し/復元/上書きは確認＋履歴＋ロールバック手段  
- ログ・データはユーザーのローカル/OneDrive内に閉じる（外部送信しない）

## 運用制約
- 自動同期は維持（便利さを落とさない）  
- ただし **失敗を可視化**し、手動介入（再試行/再ログイン/同期OFF）を可能にする  
- “勝手に直す”より“壊れたら戻す”を優先（lastGood＋復元UI）
